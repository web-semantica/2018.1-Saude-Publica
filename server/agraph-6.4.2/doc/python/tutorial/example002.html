
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Example 2: Asserting and retracting triples &#8212; AllegroGraph Python client 100.2.0.dev0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '100.2.0.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example 3: A SPARQL query" href="example003.html" />
    <link rel="prev" title="Example 1: Creating a repository and triple indices" href="example001.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
    <div class="nav-links nav-links-header">
        &laquo;<a href="example001.html" title="previous chapter">Example 1: Creating a repository and triple indices</a>
      <a href="example003.html" title="next chapter">Example 3: A SPARQL query</a> 
      &raquo;
    </div>
  
    
  <div class="section" id="example-2-asserting-and-retracting-triples">
<span id="example2"></span><h1>Example 2: Asserting and retracting triples<a class="headerlink" href="#example-2-asserting-and-retracting-triples" title="Permalink to this headline">¶</a></h1>
<p>In this example we show how to create resources describing two people,
Bob and Alice, by asserting triples into the repository. The example
also retracts and replaces a triple. Assertions and retractions to the
triple store are executed by <a class="reference internal" href="../_gen/franz.openrdf.repository.html#franz.openrdf.repository.repositoryconnection.RepositoryConnection.add" title="franz.openrdf.repository.repositoryconnection.RepositoryConnection.add"><code class="xref py py-meth docutils literal"><span class="pre">add()</span></code></a> and <a class="reference internal" href="../_gen/franz.openrdf.repository.html#franz.openrdf.repository.repositoryconnection.RepositoryConnection.remove" title="franz.openrdf.repository.repositoryconnection.RepositoryConnection.remove"><code class="xref py py-meth docutils literal"><span class="pre">remove()</span></code></a> methods
belonging to the connection object, which we obtain by calling the
<code class="xref py py-meth docutils literal"><span class="pre">ag_connect()</span></code> function described in <a class="reference internal" href="example001.html#example1"><span class="std std-ref">Example 1: Creating a repository and triple indices</span></a>.</p>
<p>Before asserting a triple, we have to generate the URI values for the
subject, predicate and object fields. The AllegroGraph Python client
API predefines a number of classes and predicates for the RDF, RDFS,
XSD, and OWL ontologies. <code class="docutils literal"><span class="pre">RDF.TYPE</span></code> is one of the predefined
predicates we will use.</p>
<p>The <a class="reference internal" href="../_gen/franz.openrdf.repository.html#franz.openrdf.repository.repositoryconnection.RepositoryConnection.add" title="franz.openrdf.repository.repositoryconnection.RepositoryConnection.add"><code class="xref py py-meth docutils literal"><span class="pre">add()</span></code></a> and <a class="reference internal" href="../_gen/franz.openrdf.repository.html#franz.openrdf.repository.repositoryconnection.RepositoryConnection.remove" title="franz.openrdf.repository.repositoryconnection.RepositoryConnection.remove"><code class="xref py py-meth docutils literal"><span class="pre">remove()</span></code></a> methods take an optional
<code class="docutils literal"><span class="pre">contexts</span></code> argument that specifies one or more subgraphs that are
the target of triple assertions and retractions. When the context is
omitted, triples are asserted/retracted to/from the default graph. In
the example below, facts about Alice and Bob reside in the default
graph.</p>
<p>The second example begins by calling <code class="xref py py-meth docutils literal"><span class="pre">ag_connect()</span></code> to create the
appropriate connection object, which is bound to the variable <code class="docutils literal"><span class="pre">conn</span></code>.</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">franz.openrdf.connect</span> <span class="kn">import</span> <span class="n">ag_connect</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">ag_connect</span><span class="p">(</span><span class="s1">&#39;python-tutorial&#39;</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The next step is to begin assembling the URIs we will need for the new
triples. The <a class="reference internal" href="../_gen/franz.openrdf.repository.html#franz.openrdf.repository.repositoryconnection.RepositoryConnection.createURI" title="franz.openrdf.repository.repositoryconnection.RepositoryConnection.createURI"><code class="xref py py-meth docutils literal"><span class="pre">createURI()</span></code></a> method generates a URI from a string.
These are the subject URIs identifying the resources “Bob” and “Alice”:</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="n">alice</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">createURI</span><span class="p">(</span><span class="s2">&quot;http://example.org/people/alice&quot;</span><span class="p">)</span>
<span class="n">bob</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">createURI</span><span class="p">(</span><span class="s2">&quot;http://example.org/people/bob&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Bob and Alice will be members of the “person” class (rdf type
<code class="docutils literal"><span class="pre">person</span></code>).</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="n">person</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">createURI</span><span class="p">(</span><span class="s2">&quot;http://example.org/ontology/Person&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Both Bob and Alice will have a “name” attribute.</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">createURI</span><span class="p">(</span><span class="s2">&quot;http://example.org/ontology/name&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The name attributes will contain literal values. We have to generate the
<a class="reference internal" href="../_gen/franz.openrdf.model.html#franz.openrdf.model.Literal" title="franz.openrdf.model.Literal"><code class="xref py py-class docutils literal"><span class="pre">Literal</span></code></a> objects from strings:</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="n">bobsName</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">createLiteral</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="n">alicesName</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">createLiteral</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The next line prints out the number of triples currently in the
repository - we expect that to be zero, since we have not yet added
any triples and the <code class="docutils literal"><span class="pre">connect</span></code> function should have removed any
existing statements from the repository.</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Triple count before inserts:&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre><span></span>Triple count before inserts: 0
</pre></div>
</div>
<p>Now we assert four triples, two for Bob and two more for Alice, using
the connection object’s <a class="reference internal" href="../_gen/franz.openrdf.repository.html#franz.openrdf.repository.repositoryconnection.RepositoryConnection.add" title="franz.openrdf.repository.repositoryconnection.RepositoryConnection.add"><code class="xref py py-meth docutils literal"><span class="pre">add()</span></code></a> method. After
the assertions, we count triples again (there should be four) and print
out the triples for inspection.</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">franz.openrdf.vocabulary</span> <span class="kn">import</span> <span class="n">RDF</span>

<span class="c1"># alice is a person</span>
<span class="n">conn</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">RDF</span><span class="o">.</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">person</span><span class="p">)</span>
<span class="c1"># alice&#39;s name is &quot;Alice&quot;</span>
<span class="n">conn</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">alicesName</span><span class="p">)</span>
<span class="c1"># bob is a person</span>
<span class="n">conn</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bob</span><span class="p">,</span> <span class="n">RDF</span><span class="o">.</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">person</span><span class="p">)</span>
<span class="c1"># bob&#39;s name is &quot;Bob&quot;:</span>
<span class="n">conn</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bob</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bobsName</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Triple count:&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">conn</span><span class="o">.</span><span class="n">getStatements</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">None</span></code> arguments to the <a class="reference internal" href="../_gen/franz.openrdf.repository.html#franz.openrdf.repository.repositoryconnection.RepositoryConnection.getStatements" title="franz.openrdf.repository.repositoryconnection.RepositoryConnection.getStatements"><code class="xref py py-meth docutils literal"><span class="pre">getStatements()</span></code></a> method say that we
don’t want to restrict what values may be present in the subject, predicate,
object or context positions. Just print out all the triples.</p>
<p>This is the output at this point. We see four triples, two about Alice
and two about Bob</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Triple count: 4
(&lt;http://example.org/people/alice&gt;, &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt;, &lt;http://example.org/ontology/Person&gt;)
(&lt;http://example.org/people/alice&gt;, &lt;http://example.org/ontology/name&gt;, &quot;Alice&quot;)
(&lt;http://example.org/people/bob&gt;, &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt;, &lt;http://example.org/ontology/Person&gt;)
(&lt;http://example.org/people/bob&gt;, &lt;http://example.org/ontology/name&gt;, &quot;Bob&quot;)
</pre></div>
</div>
<p>We see two resources of type “person,” each with a literal name.</p>
<p>The next step is to demonstrate how to remove a triple. Use the
<a class="reference internal" href="../_gen/franz.openrdf.repository.html#franz.openrdf.repository.repositoryconnection.RepositoryConnection.remove" title="franz.openrdf.repository.repositoryconnection.RepositoryConnection.remove"><code class="xref py py-meth docutils literal"><span class="pre">remove()</span></code></a> method of the connection object, and supply a triple pattern
that matches the target triple. In this case we want to remove Bob’s name
triple from the repository. Then we’ll count the triples again to verify
that there are only three remaining.</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="n">conn</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">bob</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bobsName</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Triple count:&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre><span></span>Triple count: 3
</pre></div>
</div>
<p>A potentially less verbose way of adding triples is to use the
<a class="reference internal" href="../_gen/franz.openrdf.repository.html#franz.openrdf.repository.repositoryconnection.RepositoryConnection.addData" title="franz.openrdf.repository.repositoryconnection.RepositoryConnection.addData"><code class="xref py py-meth docutils literal"><span class="pre">addData()</span></code></a> method of the connection object with a string
containing triples in <a class="reference external" href="https://www.w3.org/TR/turtle/">Turtle</a>, <a class="reference external" href="https://www.w3.org/TR/n-triples/">N-Triples</a> or another RDF format.</p>
<p>Let us see how the data used in this example could be added using
<a class="reference internal" href="../_gen/franz.openrdf.repository.html#franz.openrdf.repository.repositoryconnection.RepositoryConnection.addData" title="franz.openrdf.repository.repositoryconnection.RepositoryConnection.addData"><code class="xref py py-meth docutils literal"><span class="pre">addData()</span></code></a>. We will also wrap the whole process in a function
that we’ll use later:</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_bob_and_alice</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
   <span class="n">conn</span><span class="o">.</span><span class="n">addData</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="w"></span>
<span class="w">       </span><span class="k">@base</span><span class="w"> </span><span class="nv">&lt;http://example.org/&gt;</span><span class="w"> </span><span class="p">.</span><span class="w"></span>

<span class="w">       </span><span class="nv">&lt;people/alice&gt;</span><span class="w"> </span><span class="kt">a</span><span class="w"> </span><span class="nv">&lt;ontology/Person&gt;</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">                      </span><span class="nv">&lt;ontology/name&gt;</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"></span>
<span class="w">       </span><span class="nv">&lt;people/bob&gt;</span><span class="w"> </span><span class="kt">a</span><span class="w"> </span><span class="nv">&lt;ontology/Person&gt;</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="nv">&lt;ontology/name&gt;</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The string used here is in the <a class="reference external" href="https://www.w3.org/TR/turtle/">Turtle</a> format. It is also possible
to use other formats by passing the <code class="docutils literal"><span class="pre">rdf_format</span></code> argument to
<a class="reference internal" href="../_gen/franz.openrdf.repository.html#franz.openrdf.repository.repositoryconnection.RepositoryConnection.addData" title="franz.openrdf.repository.repositoryconnection.RepositoryConnection.addData"><code class="xref py py-meth docutils literal"><span class="pre">addData()</span></code></a>.</p>
<p>We should check if the new function behaves as expected by creating a
fresh connection (recall that the <code class="docutils literal"><span class="pre">clear</span></code> parameter causes all existing
triples to be deleted):</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ag_connect</span><span class="p">(</span><span class="s1">&#39;python-tutorial&#39;</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">add_bob_and_alice</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Triple count:&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre><span></span>Triple count: 4
</pre></div>
</div>
</div>


  
    <div class="nav-links nav-links-footer">
        &laquo;<a href="example001.html" title="previous chapter">Example 1: Creating a repository and triple indices</a>
      <a href="example003.html" title="next chapter">Example 3: A SPARQL query</a> 
      &raquo;
    </div>
  

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">AllegroGraph Python client</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=franzinc&repo=agraph-python&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="setup.html">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#setting-the-environment-for-the-tutorial">Setting the environment for the tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#terminology">Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#creating-users-with-webview">Creating Users with WebView</a></li>
<li class="toctree-l2"><a class="reference internal" href="example001.html">Example 1: Creating a repository and triple indices</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Example 2: Asserting and retracting triples</a></li>
<li class="toctree-l2"><a class="reference internal" href="example003.html">Example 3: A SPARQL query</a></li>
<li class="toctree-l2"><a class="reference internal" href="example004.html">Example 4: Statement matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="example005.html">Example 5: Literal values</a></li>
<li class="toctree-l2"><a class="reference internal" href="example006.html">Example 6: Importing triples</a></li>
<li class="toctree-l2"><a class="reference internal" href="example007.html">Example 7: Querying multiple contexts</a></li>
<li class="toctree-l2"><a class="reference internal" href="example008.html">Example 8: Exporting triples</a></li>
<li class="toctree-l2"><a class="reference internal" href="example009.html">Example 9: Exporting query results</a></li>
<li class="toctree-l2"><a class="reference internal" href="example010.html">Example 10: Graphs in SPARQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="example011.html">Example 11: Namespaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="example012.html">Example 12: Free Text indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="example013.html">Example 13: SPARQL query forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="example014.html">Example 14: Parametric queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="example015.html">Example 15: Range queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="example016.html">Example 16: Federated repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="example017.html">Example 17: Triple attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="example018.html">Example 18: Pandas support</a></li>
<li class="toctree-l2"><a class="reference internal" href="fedex.html">Running AG on AWS EC2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">AllegroGraph Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Release notes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../tutorial.html">Tutorial</a><ul>
      <li>Previous: <a href="example001.html" title="previous chapter">Example 1: Creating a repository and triple indices</a></li>
      <li>Next: <a href="example003.html" title="next chapter">Example 3: A SPARQL query</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Franz Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/tutorial/example002.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>