
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Example 3: A SPARQL query &#8212; AllegroGraph Python client 100.2.0.dev0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '100.2.0.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example 4: Statement matching" href="example004.html" />
    <link rel="prev" title="Example 2: Asserting and retracting triples" href="example002.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
    <div class="nav-links nav-links-header">
        &laquo;<a href="example002.html" title="previous chapter">Example 2: Asserting and retracting triples</a>
      <a href="example004.html" title="next chapter">Example 4: Statement matching</a> 
      &raquo;
    </div>
  
    
  <div class="section" id="example-3-a-sparql-query">
<span id="example3"></span><h1>Example 3: A SPARQL query<a class="headerlink" href="#example-3-a-sparql-query" title="Permalink to this headline">¶</a></h1>
<p>SPARQL stands for the <a class="reference external" href="http://www.w3.org/TR/rdf-sparql-query/">“SPARQL Protocol and RDF Query Language,”</a> a recommendation of the
<a class="reference external" href="http://www.w3.org/">World Wide Web Consortium (W3C)</a> . SPARQL is a
query language for retrieving RDF triples.</p>
<p>Our next example illustrates how to evaluate a SPARQL query. This is
the simplest query, the one that returns all triples. Note that we
will use the same triples that were used in <a class="reference internal" href="example002.html#example2"><span class="std std-ref">Example 2: Asserting and retracting triples</span></a>.</p>
<p>Let’s create the connection first:</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">franz.openrdf.connect</span> <span class="kn">import</span> <span class="n">ag_connect</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">ag_connect</span><span class="p">(</span><span class="s1">&#39;python-tutorial&#39;</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>And now we can add our data and define the query:</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="n">conn</span><span class="o">.</span><span class="n">addData</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="w"></span>
<span class="w">    </span><span class="k">@base</span><span class="w"> </span><span class="nv">&lt;http://example.org/&gt;</span><span class="w"> </span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="nv">&lt;people/alice&gt;</span><span class="w"> </span><span class="kt">a</span><span class="w"> </span><span class="nv">&lt;ontology/Person&gt;</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">                   </span><span class="nv">&lt;ontology/name&gt;</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"></span>
<span class="w">    </span><span class="nv">&lt;people/bob&gt;</span><span class="w"> </span><span class="kt">a</span><span class="w"> </span><span class="nv">&lt;ontology/Person&gt;</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">                 </span><span class="nv">&lt;ontology/name&gt;</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">query_string</span> <span class="o">=</span> <span class="s2">&quot;SELECT ?s ?p ?o  WHERE {?s ?p ?o .}&quot;</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">SELECT</span></code> clause returns the variables <code class="docutils literal"><span class="pre">?s</span></code>, <code class="docutils literal"><span class="pre">?p</span></code> and <code class="docutils literal"><span class="pre">?o</span></code>
in the binding set. The variables are bound to the subject, predicate
and objects values of each triple that satisfies the WHERE clause. In
this case the WHERE clause is unconstrained. The dot (<code class="docutils literal"><span class="pre">.</span></code>) in the
fourth position signifies the end of the pattern.</p>
<p>The connection object’s <a class="reference internal" href="../_gen/franz.openrdf.repository.html#franz.openrdf.repository.repositoryconnection.RepositoryConnection.prepareTupleQuery" title="franz.openrdf.repository.repositoryconnection.RepositoryConnection.prepareTupleQuery"><code class="xref py py-meth docutils literal"><span class="pre">prepareTupleQuery()</span></code></a> method creates a
query object that can be evaluated one or more times. The results are
returned in an iterator that yields a sequence of binding sets.</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">franz.openrdf.query.query</span> <span class="kn">import</span> <span class="n">QueryLanguage</span>

<span class="n">tuple_query</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">prepareTupleQuery</span><span class="p">(</span><span class="n">QueryLanguage</span><span class="o">.</span><span class="n">SPARQL</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">tuple_query</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
</pre></div>
</div>
<p>Below we illustrate one method for extracting the values from a
binding set, indexed by the name of the corresponding column variable
in the <code class="docutils literal"><span class="pre">SELECT</span></code> clause.</p>
<div class="highlight-python_rdf"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">result</span><span class="p">:</span>
   <span class="k">for</span> <span class="n">binding_set</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">binding_set</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">binding_set</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">binding_set</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">o</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre><span></span>&lt;http://example.org/people/bob&gt; &lt;http://example.org/ontology/name&gt; &quot;Bob&quot;
&lt;http://example.org/people/bob&gt; &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;http://example.org/ontology/Person&gt;
&lt;http://example.org/people/alice&gt; &lt;http://example.org/ontology/name&gt; &quot;Alice&quot;
&lt;http://example.org/people/alice&gt; &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;http://example.org/ontology/Person&gt;
</pre></div>
</div>
<p>Note that we have wrapped the whole result processing in a <code class="docutils literal"><span class="pre">with</span></code>
statement. The reason is that result objects must be closed after
processing to release resources. The most convenient way to ensure
this is the <code class="docutils literal"><span class="pre">with</span></code> statement, but it is also possible to explicitly
call <a class="reference internal" href="../_gen/franz.openrdf.query.html#franz.openrdf.query.queryresult.QueryResult.close" title="franz.openrdf.query.queryresult.QueryResult.close"><code class="xref py py-meth docutils literal"><span class="pre">close()</span></code></a>
(e.g. in a <code class="docutils literal"><span class="pre">finally</span></code> block).</p>
</div>


  
    <div class="nav-links nav-links-footer">
        &laquo;<a href="example002.html" title="previous chapter">Example 2: Asserting and retracting triples</a>
      <a href="example004.html" title="next chapter">Example 4: Statement matching</a> 
      &raquo;
    </div>
  

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">AllegroGraph Python client</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=franzinc&repo=agraph-python&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="setup.html">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#setting-the-environment-for-the-tutorial">Setting the environment for the tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#terminology">Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#creating-users-with-webview">Creating Users with WebView</a></li>
<li class="toctree-l2"><a class="reference internal" href="example001.html">Example 1: Creating a repository and triple indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="example002.html">Example 2: Asserting and retracting triples</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Example 3: A SPARQL query</a></li>
<li class="toctree-l2"><a class="reference internal" href="example004.html">Example 4: Statement matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="example005.html">Example 5: Literal values</a></li>
<li class="toctree-l2"><a class="reference internal" href="example006.html">Example 6: Importing triples</a></li>
<li class="toctree-l2"><a class="reference internal" href="example007.html">Example 7: Querying multiple contexts</a></li>
<li class="toctree-l2"><a class="reference internal" href="example008.html">Example 8: Exporting triples</a></li>
<li class="toctree-l2"><a class="reference internal" href="example009.html">Example 9: Exporting query results</a></li>
<li class="toctree-l2"><a class="reference internal" href="example010.html">Example 10: Graphs in SPARQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="example011.html">Example 11: Namespaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="example012.html">Example 12: Free Text indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="example013.html">Example 13: SPARQL query forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="example014.html">Example 14: Parametric queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="example015.html">Example 15: Range queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="example016.html">Example 16: Federated repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="example017.html">Example 17: Triple attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="example018.html">Example 18: Pandas support</a></li>
<li class="toctree-l2"><a class="reference internal" href="fedex.html">Running AG on AWS EC2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">AllegroGraph Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Release notes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../tutorial.html">Tutorial</a><ul>
      <li>Previous: <a href="example002.html" title="previous chapter">Example 2: Asserting and retracting triples</a></li>
      <li>Next: <a href="example004.html" title="next chapter">Example 4: Statement matching</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Franz Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/tutorial/example003.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>