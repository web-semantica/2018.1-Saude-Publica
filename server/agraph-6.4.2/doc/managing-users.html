<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="author" content="Franz Incorporated"/>
<title>Managing Users in AllegroGraph 6.4.2</title>
<link rel='stylesheet' href='jquery-ui.custom.min.css' />
<link rel='stylesheet' href='stylesheet.css' />
<link rel='stylesheet' href='print.css' media='print' />
<body id="managing-users"><p>L  <div id="header"> <p>                 </p>                <p><script src="jquery.min.js" type="text/javascript" charset="utf-8"></script> <script src="jquery-ui.custom.min.js" type="text/javascript" charset="utf-8"></script> <script src="activebookmark.js" type="text/javascript" charset="utf-8"></script> </p> <div id='search-form'>   <form method="GET" action="https://www.google.com/search">     <input type="hidden" name="as_sitesearch" value=""> </input>     <input type="text" size="40" name="as_q" value="" placeholder="Please enable JavaScript to use search!"> </input>&nbsp;     <input type="submit" value="Search" disabled> </input>   </form> </div> <script>    /* Docudown has no support for function calls in HTML attributes. 
<ul>
<li>Thus, we set the as_sitesearch attribute using JavaScript below.    */   (function () { 'use strict'; var properValue = "franz.com/agraph/support/documentation/6.4.2/"; var input = document.querySelector(   '#search-form input[name="as_sitesearch"]'); input.setAttribute('value', properValue); /* The submit button was disabled so that search would be 
<ul>
<li>impossible for users without JavaScript. Enabling now: */ document.querySelector('#search-form input[type="submit"]').   removeAttribute('disabled'); document.querySelector('#search-form input[name="as_q"]').   removeAttribute('placeholder');   })(); </script> <div id="copyright">  Copyright (c) 2005 - 2018 Franz, Incorporated</div> <div id="timestamp">  Last updated 8 June 2018 at 06:55</div> <a href="https://franz.com" alt="Franz Inc Home Page"><div id="hdLogo"> </div></a> </li></ul></li></ul>  </p>     <h1>AllegroGraph 6.4.2 Managing Users and Roles</h1></div> <div id="contents">  <div id="docIndex"> <ul id="agmenu"> <li><a href="index.html">Documentation Index</a> 
<ul>
<li><a href="release-notes.html">Release Notes</a></li>
<li><a href="agraph-quick-start.html">Quick Start</a></li>
<li><a href="agraph-introduction.html" id="agraph-introduction-tab">Introduction</a></li>
<li>Setup and Configuration
<ul>
<li><a href="http://franz.com/agraph/downloads/" target="_blank">Download</a></li>
<li><a href="server-installation.html">Server Installation</a></li>
<li><a href="daemon-config.html">Server Configuration and Control</a></li>
<li><a href="agwebview.html">WebView</a></li>
<li><a href="upgrade-guide.html">Database Upgrading</a></li></ul></li>
<li>Server Management
<ul>
<li><a href="performance-tuning.html">Performance Tuning</a></li>
<li><a href="deleting-duplicate-triples.html">Deleting Duplicate Triples</a></li>
<li><a href="purging-deleted-triples.html">Purging Deleted Triples</a></li>
<li><a href="audit.html">Auditing</a></li>
<li><a href="managing-users.html">Managing Users</a></li>
<li><a href="replication.html">Replication</a></li>
<li><a href="point-in-time-recovery.html">Point-in-Time Recovery</a></li>
<li><a href="transaction-log-archiving.html">Transaction Log Archiving</a></li>
<li><a href="security-overview.html">Security Overview</a></li>
<li><a href="security.html">Security Implementation</a></li></ul></li>
<li>Tools
<ul>
<li><a href="agtool.html">agtool</a></li>
<li><a href="agload.html">Data Loading</a></li>
<li><a href="agexport.html">Data Export</a></li>
<li><a href="backup-and-restore.html">Backup and Restore</a></li>
<li><a href="agquery.html">Querying</a></li>
<li><a href="reasoner-tutorial.html" id="reasoner-tutorial-tab">RDFS++</a></li>
<li><a href="materializer.html">Materializer</a></li></ul></li>
<li>Details
<ul>
<li><a href="triple-index.html">AllegroGraph Indices</a></li>
<li><a href="text-index.html">Full-text Indices</a></li>
<li><a href="encoded-ids.html">Encoded IDs</a></li>
<li><a href="connection-pooling.html">Connection Pooling</a></li>
<li><a href="geospatial-nd.html">N-dimensional Geospatial Overview</a></li>
<li><a href="magic-properties.html#sparql-magic-geo-2d">2-D Geospatial</a></li>
<li><a href="magic-properties.html#sparql-magic-temporal">Temporal</a></li>
<li><a href="magic-properties.html#sparql-magic-sna">Social Network</a></li>
<li><a href="javascript.html">JavaScript</a></li>
<li><a href="datatypes.html">Datatypes</a></li>
<li><a href="rapper.html">Data Conversion (Rapper)</a></li>
<li><a href="stored-procedures.html">Stored Procedures</a></li>
<li><a href="triple-attributes.html">Triple Attributes</a></li></ul></li>
<li>Querying
<ul>
<li><a href="sparql-overview.html">SPARQL documentation summary</a></li>
<li><a href="sparql-reference.html">SPARQL Reference</a></li>
<li><a href="spin.html">SPIN</a></li>
<li><a href="magic-properties.html">SPARQL Magic Properties</a></li>
<li><a href="prolog-tutorial.html">Prolog</a></li></ul></li>
<li>3rd-party tools
<ul>
<li><a href="solr-index.html">Solr text Indices</a></li>
<li><a href="mongo-interface.html">MongoDB integration</a></li>
<li><a href="TBCplugin.html">TopBraid Composer Plugin</a></li>
<li><a href="agraph-introduction.html#othertools">Cloudera</a></li></ul></li>
<li>Client APIs
<ul>
<li><a href="http://franz.com/agraph/gruff/" title="Gruff" target="_blank">Gruff</a></li>
<li><a href="http-protocol.html">REST/HTTP interface</a></li>
<li><a href="http-reference.html">HTTP reference</a></li>
<li><a href="javadoc/index.html">Javadocs (Sesame and Jena)</a></li>
<li><a href="python/index.html">Python API</a></li>
<li><a href="lisp-reference.html">Lisp Reference</a></li>
<li><a href="javascript.html">JavaScript</a></li></ul></li>
<li>Tutorials
<ul>
<li><a href="geospatial-nd-tutorial.html">N-dimensional Geospatial</a></li>
<li><a href="sparql-tutorial.html">SPARQL Tutorial</a></li>
<li><a href="java-tutorial/java-tutorial.html">Java Sesame</a></li>
<li><a href="java-tutorial/jena-tutorial.html">Java Jena</a></li>
<li><a href="python/tutorial.html">Python Sesame</a></li>
<li><a href="lisp-quickstart.html">Lisp</a></li>
<li><a href="prolog-tutorial.html">Prolog</a></li>
<li><a href="tutorial-index.html">More...</a></li></ul></li>
<li>Other
<ul>
<li><a href="suggested-reading.html">Suggested Reading</a></li>
<li><a href="http://franz.com/ps/services/conferences_seminars/" title="Conferences and Seminars" target="_blank">Conferences and Seminars</a></li>
<li><a href="http://github.com/franzinc">Source Code on Github</a></li>
<li><a href="http://agraph.franz.com/cresources/index.lhtml" target="_blank">Community Resources</a></li>
<li><a href="http://franz.com/agraph/ec2/">Amazon EC2</a></li>
<li><a href="copyrights.html">Copyrights</a></li>
<li><a href="change-history.html" id="change-history-tab">Change History</a></li></ul></li>
<li><a href="http://franz.com/" target="_blank">Franz, Inc.</a> </li> </ul> </li></ul><p><script> $(function() { $( "#agmenu" ).menu(); }); </script> </p></div>   
<div class='table-of-contents' id='table-of-contents'>

<ul>
<li><a href='#header2-8' title='Introduction'>Introduction</a></li>
<li><a href='#header2-13' title='Managing users'>Managing users</a>
<ul>
<li><a href='#header3-18' title='Allowable user and role names'>Allowable user and role names</a></li>
<li><a href='#header3-20' title='Managing users with agtool: general comments'>Managing users with agtool: general comments</a></li>
<li><a href='#header3-48' title='Managing users with AGWebView: general comments'>Managing users with AGWebView: general comments</a></li>
<li><a href='#header3-56' title='Adding and removing a user'>Adding and removing a user</a>
<ul>
<li><a href='#header4-60' title='Adding a new user with AGWebView'>Adding a new user with AGWebView</a></li>
<li><a href='#header4-67' title='Adding a new user with agtool'>Adding a new user with agtool</a></li></ul></li>
<li><a href='#header3-74' title='Anonymous access'>Anonymous access</a></li>
<li><a href='#header3-78' title='User Permissions and Access Controls'>User Permissions and Access Controls</a>
<ul>
<li><a href='#header4-85' title='General permissions'>General permissions</a></li>
<li><a href='#header4-101' title='Repository access controls'>Repository access controls</a></li>
<li><a href='#header4-122' title='Security filters'>Security filters</a></li></ul></li>
<li><a href='#header3-134' title='Other operations on users'>Other operations on users</a>
<ul>
<li><a href='#header4-135' title='User suspension and disabling'>User suspension and disabling</a></li>
<li><a href='#header4-149' title='User password modification'>User password modification</a></li></ul></li></ul></li>
<li><a href='#header2-160' title='Roles'>Roles</a>
<ul>
<li><a href='#header3-174' title='Managing roles with agtool role and agtool user'>Managing roles with agtool role and agtool user</a></li></ul></li>
<li><a href='#header2-193' title='HTTP interface'>HTTP interface</a></li></ul>
<div id='tocLink'><a href='index.html'>Documentation Index</a></div>
</div>
  <div id="main-content"> <a name='header2-8' id='header2-8'></a><h2>Introduction</h2><p>AllegroGraph allows specifying users and giving each user specific permissions which allows certain operations and forbids others. An initial superuser is created when AllegroGraph is installed. A superuser has full power to do anything to a running AllegroGraph. Additional superusers can be created and also users with less power. An anonymous user (who can log in without a password) can also be permitted. </p><p>Note that certain permissions (particularly the <strong>Evaluate arbitrary code</strong> permission) effectively allow a knowledgeable user to act like a superuser even without formal superuser privileges. These permissions are noted when they are described below. </p><p>AllegroGraph supports Role Based Access Control (<a href="https://en.wikipedia.org/wiki/Role-based_access_control">RBAC</a>). A <strong>role</strong> is a collection of permissions. A user who is assigned a particular role has all the permissions of that role (as well as, perhaps, additional permissions separate from the role). Roles are simply a convenience which allows a standard set of permissions to be quickly given to a user. </p><p><a name="managing-users"></a> </p><a name='header2-13' id='header2-13'></a><h2>Managing users</h2><p>Users have names and (except for anonymous users) passwords. They also have permissions which allow them to perform some actions and not perform others. They may have roles (see <a href="#managing-roles">Managing roles</a> below). </p><p>Users are managed primarily with <a href="agwebview.html">AGWebView</a> and <a href="agtool.html">agtool</a>. The <a href="http-protocol.html">REST/HTTP interface</a> can also be used to manage users and roles. In this document, we describe the <a href="agwebview.html">AGWebView</a> and <a href="agtool.html">agtool</a> interfaces in detail and make only passing mention of the <a href="http-protocol.html">REST/HTTP interface</a>. </p><p>Certain configuration directives affect users. These are listed in the <a href="daemon-config.html#TopLevelAccount">Top-level directives for account management</a> section of the <a href="daemon-config.html">Server Configuration and Control</a> document. These affect things like password requirements, automatic suspension or disabling because of lack of use or apparent improper use, and specialized choices like <code>SuperUserCanAccessAllData</code>, which specifies whether superusers can access data by default or must first add access for themselves (an action that is added to the audit log if auditing is enabled). These options must be specified in the configuration file and cannot be changed in a running AllegroGraph server. To change these directives, edit the configuration file and then restart the server. </p><p><a name="user-role-names"></a> </p><a name='header3-18' id='header3-18'></a><h3>Allowable user and role names</h3><p>User and role names may consist of any chacacters except \ (backslash), : (colon), / (forward slash), ~ (tilde), or those characters with code below 32 (that is control characters). The names "." and ".." are also not permitted. </p><a name='header3-20' id='header3-20'></a><h3>Managing users with agtool: general comments</h3><p><strong>agtool user</strong> is the most powerful and flexible way to manage users (the REST/HTTP interface is as powerful but not as convenient, while the AGWebView interface lacks some features). </p>
<pre><code>agtool user help </code></pre><p>displays the various operations. </p>
<pre><code>agtool user &lt;operation&gt; --help </code></pre><p>displays usage for a specific operation. The general form is </p>
<pre><code>agtool user [--server server-spec] &lt;operation&gt; [options] user </code></pre><p>The <code>--server</code> argument defaults to <code>--server localhost:10035</code>. <code>server-spec</code> can be <code>HOSTNAME</code> or <code>HOSTNAME:PORT</code> or <code>SCHEME:HOSTNAME:PORT</code> or <code>SCHEME://[user:password@]HOSTNAME:PORT</code>. (<code>SCHEME</code> is <code>http</code> or <code>https</code>.) </p><p>If the user who started the AllegroGraph server is executing <strong>agtool user</strong> on the machine on which AllegroGraph server is running, <strong>agtool user</strong> will then run under the same uid that the AllegroGraph server is running under. In that case, <strong>agtool user</strong> acts as if it is being run by a superuser even if the user and password are not specified. This behavior is called <em>OS authentication</em>. It is common for production versions to be run this way, and it is also typical for users who are testing personal copies. </p><p>A superuser can run any <strong>agtool user</strong> operation. Other users can run some (generally those that provide information about themselves and in some cases set information, like passwords). </p><p>The list of operations include: </p>
<ul>
<li>help - Display user usage.</li>
<li>info - Prints information about the user.</li>
<li>list - Prints a list of all users.</li>
<li>expire - Expires password for a user.</li>
<li>remove - Removes a user.</li>
<li>add - Adds a user.</li>
<li>unsuspend - Unsuspends a user account.</li>
<li>suspend - Suspends a user account.</li>
<li>disable - Disables a user account.</li>
<li>enable - Enables a user account.</li>
<li>set-password - Sets password for a user</li>
<li>remove-roles - Removes role(s) from a user</li>
<li>add-roles - Adds role(s) to a user</li>
<li>permissions - Modifies a user by adding or removing permissions.</li>
<li>revoke - Revokes specified access rights for specified repos from a user.</li>
<li>grant - Grants specified access rights for specified repos to a user.</li></ul><p>We describe <a href="#adding-users">adding/removing users</a>, and <a href="#user-permissions">granting and revoking permissions and access</a> in separate sections below, and then other commands in an <a href="#general-commands">other operations section</a>. </p><a name='header3-48' id='header3-48'></a><h3>Managing users with AGWebView: general comments</h3><p>Only a superuser can add or remove users and can change the permissions of a user. Superusers can also change a user's password, though that can also be done by the user if the <a href="daemon-config.html#PasswordChangeAllowed">PasswordChangeAllowed</a> configuration directive is <em>yes</em> (the default). </p><p>Superusers have access to the <strong>Admin</strong> menu, and it includes a <strong>Users</strong> item which, when chosen, displays the Users Page. </p><p><img src="agwv-admin-menu-users.jpg" alt="The Admin menu with Users indicated"></img> </p><p>The User page displays a list of current users: </p><p><img src="user-page.jpg" alt="User list and Add a User link"></img> </p><p>AGWebView tools for managing users start on this page. In what follows, we assume things are being done by a superuser and the User page is displayed at the start of any set of instructions. </p><p><a name="adding-users"></a> </p><a name='header3-56' id='header3-56'></a><h3>Adding and removing a user</h3><p>When AllegroGraph is configured after installation (see <a href="server-installation.html">Server Installation</a>) a single user, with superuser privileges is created. Then, if <strong>agtool archive restore</strong> or <strong>agtool archive restore-settings</strong> is called (with appropriate arguments, see <a href="backup-and-restore.html">Backup and Restore</a>), existing users from an existing AllegroGraph (perhaps an earlier version) are added along with all their permissions and roles. </p><p>To add a new user or to remove a user, use AGWebView or <strong>agtool user</strong> as follows. </p><p><a name="adding-users-agwv"></a> </p><a name='header4-60' id='header4-60'></a><h4>Adding a new user with AGWebView</h4><p>Only a superuser can add a new user. When logged in as a superuser, display the <strong>Admin</strong> menu and choose <strong>Users</strong> to display the User page, which displays a list of current users, and a link after the list to add a new user: </p><p><img src="agwv-add-a-user.jpg" alt="User list and Add a User link"></img> </p><p>Clicking on that link displays a dialog asking for the new user name and password (we have filled in the name <em>user3</em> and a value for the password): </p><p><img src="agwv-new-user-dialog.jpg" alt="New user dialog"></img> </p><p>clicking on <em>Ok</em> adds the new user. See <a href="#user-permissions">below</a> for information on specifying the permissions of the new user. </p><p>The User page displayed above already had three users (test, the initial superuser, and user1 and user2). Note that each has a <strong>[remove]</strong> link next to the username. Clicking on that will remove a user (after confirmation in a dialog box). </p><a name='header4-67' id='header4-67'></a><h4>Adding a new user with agtool</h4><p>The general form of the command for adding a user with <strong>agtool user</strong> is </p>
<pre><code>agtool user add [--server &lt;server-spec&gt;] username [password] </code></pre><p>A user with name <code>username</code> and password <code>password</code> is added. <code>password</code> is shown as optional but is required unless <code>username</code> is <code>anonymous</code> (the single username which can allow passwordless access). </p><p>The general for for removing a user with <strong>agtool user</strong> is </p>
<pre><code>agtool user remove [--server &lt;server-spec&gt;] username </code></pre><p><a name="anonymous-access"></a> </p><a name='header3-74' id='header3-74'></a><h3>Anonymous access</h3><p>A special user named <em>anonymous</em> can be created without a password. This can be done in AGWebView or with <strong>agtool user</strong> as described <a href="#adding-users">above</a>, leaving out the password. <em>anonymous</em> (the case is significant, all lowercase) is the only user account that can be created without a password. </p><p>If such an account exists, anyone who can access the server machine over the Internet (such as <em>machine:port</em>) in a browser can log in as anonymous. They can then do whatever the permissions and access for <em>anonymous</em> allows (which is presumably not too much because otherwise this would be a security hole). </p><p><a name="user-permissions"></a> </p><a name='header3-78' id='header3-78'></a><h3>User Permissions and Access Controls</h3><p>Permissions allow users to perform certain actions. Access controls control access to data in repositories (for reading, writing, or both). The general list of user permissions and access controls is displayed when the <strong>[Edit]</strong> button (which has been done for user1 in the illustration): </p><p><img src="user-permissions.jpg" alt="User permissions"></img> </p><p>There are five general permissions. Those five are shown next to check boxes in the illustration above and are listed by </p>
<pre><code>agtool user permissions --help </code></pre><p>Then there are <a href="#access-user-permissions">access controls to individual catalogs and repositories</a> and <a href="#sec-filters">security filters</a>, both described after the general permissions. </p><p><a name="general-user-permissions"></a> </p><a name='header4-85' id='header4-85'></a><h4>General permissions</h4><p>The five general permissions are (each is listed with the name visible on the Users Page in AGWebView followed by, in parentheses, the name of the permission when using <strong>agtool user permissions</strong>): </p>
<ul>
<li><p>Superuser (super) - a superuser can perform most any action, except   perhaps viewing all data by default. See the   <code>SuperUserCanAccessAllData</code> configuration directive in the   <a href="daemon-config.html#TopLevelAccount">Top-level directives for account   management</a> section of the   <a href="daemon-config.html">Server Configuration and Control</a> document. If a   superuser does not have permission to view a repository, he/she can   add it but that action will be logged by the audit process if   auditing is enabled (see <a href="audit.html">Auditing</a>). </p></li>
<li><p>Start sessions (session) - A user with the <strong>Start Sessions</strong>   permission can use the AllegroGraph features that require spawning a   dedicated session, such as Transactions and Social Network Analysis   (SNA). If you try to use these features without the appropriate   permission, you'll encounter authorization errors. This permission   should be withheld from users who do not need it because it spawns   back-end processes that occupy memory and consume CPU cycles. </p></li>
<li><p>Evaluate arbitrary code (eval) - A user with permission to   <strong>Evaluate Arbitrary Code</strong> can run <a href="agwebview.html#Prolog">Prolog "select"   queries</a>. This user can also do anything else   that allows executing Lisp code, such as defining Prolog <strong>select</strong>   generators for SNA, or doing eval-in-server, as well as loading   server-side files. This permission should be withheld from users who   are not fully trusted and even among trusted users, it should be   granted only to those who need it. The ability to evaluate code in the   hands of a knowledgeable user is equivalent to superuser privileges. </p></li>
<li><p>Control Replication (replication) - The <strong>Control Replication</strong>   permission allows a user to set up automatic replication of a   repository across multiple servers. See <a href="multi-master.html">Multi-master   Replication</a> and also <a href="replication.html">Replication</a>. </p></li>
<li><p>Allow user attributes via HTTP header x-user-attributes   (user-attributes-header) - The <strong>Allow user attributes via HTTP   header x-user-attributes</strong> permission allows the user to supply user   attributes using the <code>x-user-attributes</code> header. See the <a href="triple-attributes.html#static-filters">Static   filters</a> section of the   <a href="triple-attributes.html">Triple Attributes</a> document for more   information. </p></li>
<li><p>Allow user attributes via SPARQL PREFIX franzOption_userAttributes   (user-attributes-prefix) - The <strong>Allow user attributes via SPARQL   PREFIX franzOption_userAttributes</strong> permission allows the user to   specify user attributes in a SPARQL query using the PREFIX   <code>franzOption_userAttributes</code>. See   <a href="sparql-reference.html#query-option.userAttributes">here</a> in the   <a href="sparql-reference.html">SPARQL Reference</a> document for more information   on that prefix. </p></li></ul><p>In the illustration below, we have given user1 permission to Control replication and allowed user1 to specify user attributes via the HTTP header x-user-attributes and by the SPARQL PREFIX franzOption_userAttributes: </p><p><img src="user1-permissions.jpg" alt="User1 permissions"></img> </p><p>Calling </p>
<pre><code>agtool user info --server &lt;server-spec&gt; user1 </code></pre><p>prints </p>
<pre><code>Access:  
Roles:  
Permissions: user-attributes-prefix user-attributes-header replication </code></pre><p>Here <server-spec> specifies a superuser or user1 (but no other users without superuser permission). </p><p><a name="access-user-permissions"></a> </p><a name='header4-101' id='header4-101'></a><h4>Repository access controls</h4><p>Users can be given permission to access data in repositories. The access can be read/write, or just read or just write. </p><p>Superusers typically have read/write access to all data unless the <code>SuperUserCanAccessAllData</code> configuration directive (described in the <a href="daemon-config.html#TopLevelAccount">Top-level directives for account management</a> section of the <a href="daemon-config.html">Server Configuration and Control</a> document) has the value <em>no</em> (the default is <em>yes</em>). In that case, they must be given access to individual repositories just like all users, the only difference being they can give it to themselves (but that action appears in the <a href="audit.html">audit</a> log if auditing is enabled). </p><p>Here (from above) are the permissions for user1: </p><p><img src="user1-permissions.jpg" alt="User1 permissions"></img> </p><p>No data access is allowed, as indicated by the statement <strong>No read/write access</strong>. Access can be granted to individual repositories or groups of repositories by using the </p>
<pre><code>Grant [read/write] on catalog [*   ] repository [*     ] [ok] </code></pre><p>command. </p><p>Clicking <strong>[ok]</strong> with those specifications (read/write, * for catalog and repository) would grant read/write access on all repositories in all catalogs. But the three boxes are drop-down menus which can restrict the choice down to a specific repo. In the next illustration, the catalog is / (the root catalog) and the repository drop-down menu has choices * (all repos in the catalog), <em>kennedy</em>, and <em>myrepo</em>. </p><p><img src="user-repo-access.jpg" alt="User1 access to repos"></img> </p><p>We allow read/write access for <em>kennedy</em> and read access for <em>myrepo</em>. Now the user1 profile looks like: </p><p><img src="user1-access-repos.jpg" alt="User1 access to repos granted"></img> </p><p>and <strong>agtool user info</strong> reports </p>
<pre><code>Access: root:kennedy:rw root:myrepo:r  
Roles:  
Permissions: user-attributes-prefix user-attributes-header replication </code></pre><p>Access can be denied by clicking <strong>[remove]</strong> next the access permission in AGWebView. </p><p>Using <strong>agtool user</strong>, grant access with </p>
<pre><code>agtool user grant --server &lt;server-spec&gt; root:kennedy:rw root:myrepo:r </code></pre><p>(repos and access are specified by <em>catalog</em>:<em>repo</em>:<rw|r|w>.) </p><p>Using <strong>agtool user</strong>, revoke access with </p>
<pre><code>agtool user revoke --server &lt;server-spec&gt; root:kennedy:rw root:myrepo:r </code></pre><p><a name="sec-filters"></a> </p><a name='header4-122' id='header4-122'></a><h4>Security filters</h4><p>The final user setting is specifying security filters. Note in release 6.4.2, security filters cannot be set or removed with <strong>agtool user</strong>. </p><p>Security filters are described in more detail in <a href="security.html#filters">Security filtering</a> in the <a href="security.html">Security Implementation</a> document. In short, users can be prevented from seeing triples with certain specific content (such as any triple whose predicate is <www.franz.com#salary>) or allowed only to see triple with specific content (so user1 could be only allowed to see triples whose graph is <www.franz.com#generalInfo>). See the <a href="security.html#filters">discussion</a> linked to above for further details. </p><p>Here (repeated from above) is the profile for user1 as shown in AGWebView. All the permissions and access granted above are shown. </p><p><img src="user1-access-repos.jpg" alt="User1 access to repos granted"></img> </p><p>To add security filters. click on <strong>[Add]</strong> next to <strong>Security Filters</strong>. The following dialog appears: </p><p><img src="user-add-sec-filter.jpg" alt="User1 add security filter"></img> </p><p>Select <em>allow</em> or <em>disallow</em> and specify the subject, predicate, object, and/or graph of interest - for example <em>disallow</em> triples with predicate <www.franz.com#salary> as shown </p><p><img src="sec-filter-dis-salary.jpg" alt="Security filter choice"></img> </p><p>and click <em>Add</em>. Now the user1 profile in AGwebView is </p><p><img src="user1-profile-final.jpg" alt="User1 profile"></img> </p><p><a name="general-commands"></a> </p><a name='header3-134' id='header3-134'></a><h3>Other operations on users</h3><a name='header4-135' id='header4-135'></a><h4>User suspension and disabling</h4><p>User accounts can be <em>suspended</em> or <em>disabled</em>. These sound similar but are distinct. Both can be done by a superuser with <strong>agtool</strong> and <strong>AGWebView</strong> but both can occur automatically under certain circumstances. Suspensions might be removed automatically but a disabled account can only be re-enabled by a superuser. </p><p><strong>User suspension</strong>: A suspended user cannot log in to their   AllegroGraph account or issue any command via tools like <strong>agtool</strong>   or the HTTP REST interface which requires a username and   password. Superusers can unsuspend suspended users and in certain   cases, suspensions are lifted automatically. See the <a href="daemon-config.html#TopLevelAccount">Top-level   directives for account   management</a> section of the   <a href="daemon-config.html">Server Configuration and Control</a> document. It   describes the configuration directives <code>MaxFailedLogins</code> and   <code>AccountUnsuspendTimeout</code>. An account is automatically suspended if   there are <code>MaxFailedLogins</code> in a row. The account is unsuspended   automatically after <code>AccountUnsuspendTimeout</code> seconds (regardless of   whether suspension was caused by too many bad login attempts in a   row or by superuser action). Only a superuser can unsuspend an   account before <code>AccountUnsuspendTimeout</code> seconds have passed since   suspension or if <code>AccountUnsuspendTimeout</code> is unset. </p><p>In AGWebView, users are suspended on the Users page (displayed by the Admin | Users menu item). A <strong>suspend</strong> button is available when the information on a user is displayed, as shown (for user1) in the illustration: </p><p><img src="user-page-user-top.jpg" alt="Buttons at the to of User information"></img> </p><p>Using <strong>agtool user</strong>, the following command suspends user1: </p>
<pre><code>agtool user suspend &lt;server-spec&gt; user1 </code></pre><p>When a user is suspended, the button in AGWebView changes to <strong>unsuspend</strong> and the <strong>agtool user</strong> command to unsuspend is the same as that to suspend with <em>suspend</em> replaced by <em>unsuspend</em>. </p><p><strong>Disabling a user</strong>: see the <a href="daemon-config.html#TopLevelAccount">Top-level directives for account   management</a> section of the   <a href="daemon-config.html">Server Configuration and Control</a> document. It   describes the configuration directives <code>PasswordExpiry</code> and   <code>PasswordExpiryGrace</code>. An account is automatically disabled if a   password expires and the grace period passes. Once an acount   is disabled, it can only be re-enabled by an administrator (i.e.   a supersuer). Disabled accounts are never automatically re-enabled   (as suspended accounts might be). </p><p>In AGWebView, users are disabled on the Users page (displayed by the Admin | Users menu item). A <strong>disable</strong> button is available when the information on a user is displayed, as shown (for user1) in the illustration: </p><p><img src="user-page-user-top.jpg" alt="Buttons at the to of User information"></img> </p><p>Using <strong>agtool user</strong>, the following command disables user1: </p>
<pre><code>agtool user disable &lt;server-spec&gt; user1 </code></pre><p>When a user is disabled, the button in AGWebView changes to <strong>enable</strong> and the <strong>agtool user</strong> command to enable is the same as that to disable with <em>disable</em> replaced by <em>enable</em>. </p><a name='header4-149' id='header4-149'></a><h4>User password modification</h4><p>See the section <a href="security.html#usernames-passwords">Usernames and passwords</a> in the <a href="security.html">Security Implementation</a> for more information on the security issues associated with passwords. </p><p>In AGWebView, here is the profile of user1 on the Users page displayed (for superusers) by the <strong>Admin | Users</strong> menu item: </p><p><img src="user-permissions.jpg" alt="User1 profile"></img> </p><p>Note <strong>[change password]</strong> next to the username and <strong>[expire password]</strong> in the list of actions just below the <em>Roles</em> line. </p><p>Clicking on <strong>[change password]</strong> displays a dialog allowing a new passord to be specified. </p><p>Clicking on <strong>[expire password]</strong> expires the password. The next time user1 tries to log in, this warning and dialog will appear: </p><p><img src="expired-password.jpg" alt="Password expired dialog"></img> </p><p>There are a number of configuration directives that control passwords. They can, if set, specify password minimum length, that passwords must contain numbers or non-alphanumeric characters, how often a password must be changed, and so on. Users may also be prevented from changing their own passwords and have to contact a superuser for assistance when a password must be set. </p><p>See the <a href="daemon-config.html#TopLevelAccount">Top-level directives for account management</a> section of the <a href="daemon-config.html">Server Configuration and Control</a> document. It lists the directives relating to passwords. </p><p><a name="managing-roles"></a> </p><a name='header2-160' id='header2-160'></a><h2>Roles</h2><p>A role is a collection of permissions and access rights. When a user is assigned a role, all the role's permissions and access rights are given to the user. Roles have names. See <a href="#user-role-names">Allowable user and role names</a> above for allowable names. </p><p>Roles are simply a convenient shorthand for use when multiple users will be given the same set of permissions and access rights. Instead of editing the profile for each user in the set, you define a role with the desired permissions and access rights and assign the role to each user in the set. </p><p>In AGWebView, roles are defined and listed on the Users page displayed by the <strong>Admin|Users</strong> menu item, just like users. To add a role, click <strong>[add a role]</strong> at the bottom of the <strong>Roles</strong> section of the Users page. </p><p><img src="add-role.jpg" alt="Adding a role"></img> </p><p>That displays a dialog asking for a name for the new role: </p><p><img src="new-role-name.jpg" alt="Naming a role"></img> </p><p>Once the role is created, it is listed under <strong>Roles</strong>. Next to its name are boxes <strong>[remove]</strong> and <strong>[edit]</strong>. Clicking <strong>[remove]</strong> removes the role (after confirmation). Clicking <strong>[edit]</strong> displays the same collection of permissions and access rights as for a user. </p><p><img src="role-profile.jpg" alt="Role profile"></img> </p><p>As we said, role permissions are identical to user permissions. See the sections starting with <a href="#user-permissions">User permissions</a> above for more information. </p><p>In the next picture, we have added some permissions and a security filter: </p><p><img src="role-profile-filled.jpg" alt="role with permissions"></img> </p><p>Then in the Users section, we add the <em>tech1</em> role to user2: </p><p><img src="user2-and-role-profile.jpg" alt="user2 with tech1 role"></img> </p><a name='header3-174' id='header3-174'></a><h3>Managing roles with agtool role and agtool user</h3><p>Roles are defined and managed with the <strong>agtool role</strong> command: </p>
<blockquote><p>agtool role help </p></blockquote>
<pre><code>Usage: agtool role COMMAND [ OPTIONS ] ... <p>where COMMAND is one of: </p>
<ul>
<li>help - Display role usage.</li>
<li>info - Prints information about the role.</li>
<li>list - Prints a list of all roles.</li>
<li>remove - Deletes a role.</li>
<li>add - Creates a role.</li>
<li>permissions - Modifies a role by adding or removing permissions.</li>
<li>revoke - Revokes specified access rights for specified repos to a role.</li>
<li>grant - Grants specified access rights for specified repos to a role.</li></ul></code></pre><p>The <em>OPTIONS</em> include <code>--server &lt;server-spec&gt;</code> which must specify a superuser. The list is similar to those <strong>agtool user</strong> commands dealing with permissions and access (and again, in this release, security filters cannot be managed with <strong>agtool role</strong>). </p><p>A role is added to a user with </p>
<pre><code>agtool user add-roles --server &lt;server-spec&gt; user role-name </code></pre><p>and removed with </p>
<pre><code>agtool user remove-roles --server &lt;server-spec&gt; user role-name </code></pre><p>In both cases, <code>&lt;server-spec&gt;</code> which must specify a superuser. </p><a name='header2-193' id='header2-193'></a><h2>HTTP interface</h2><p>See <a href="http-protocol.html">HTTP Protocol - SPARQL Endpoint</a> for information on AllegroGraph's HTTP interface. The interface for managing users is <a href="http-protocol.html#users">here</a> in that document. </p></div>  <p><script> $.each($("#agmenu ul li a"), function(ignore, link) {   var anchor = $(link);   anchor.parent().on("click", function () { window.location = anchor.prop("href"); }); }); $("#agmenu").css("display", "block") </script> </p> 
</body>
</html>
